# 牛顿插值 & 泰勒展开

先介绍背景：给若干个点，拟合经过这些点的函数代数式。

牛顿插值基于多项式的性质（关于多项式能拟合曲线的几何原理可见[如何通俗地解释泰勒公式](https://www.matongxue.com/madocs/7/)），在根据由$n$个点生成的函数$f_n$（本质是多项式函数，是对函数$f$的$n+1$个点拟合的结果）与新加入的节点$(x_{n+1},f(x_{n+1}))$来生成新的拟合函数$f_{n+1}$。（下面看到函数$f$有下标的都是对$f$的拟合函数，下标为多少表示由多少个点+1拟合而来）

而泰勒展开正是基于牛顿插值，将点集偏序后变为相邻两节点等距，然后得到的公式。

访问 [马同学的从牛顿插值法到泰勒公式](https://www.matongxue.com/madocs/126) 来看看牛顿插值拟合的效果。

## 牛顿插值

求解过程：

1. 经过一个点的拟合函数为一个点，$f_0(x_0) = f(x_0)$。
2. 已知 $\left(x_{0}, f\left(x_{0}\right)\right),\left(x_{1}, f\left(x_{1}\right)\right)$ 这两个点，求满足经过两个点的 $f_{1}(x)$ 函数。
   - 假设 $ f_{1}(x)=f_0(x)+b_{1}(x-x_{0})$，$(x-x_{0})$ 可以保证 $f_{1}(x_{0})=f(x_{0})$（由于$f_0(x_0) = f(x_0)$，下面的$f_2(x_1) = f(x_1)$同理），同时令$f_1(x_1) = f(x_1)$，即令拟合函数$f_1$同时经过$f$的两个点。
   - $b_{1}=\frac{f(x_{1})-f_0(x_{1})}{x_{1}-x_{0}} $
     $f_{1}(x)=f_0(x)+\frac{f(x_{1})-f_0(x_{0})}{x_{1}-x_{0}}(x-x_{0})$
3. 已知 $(x_{0}, f(x_{0})),(x_{1}, f(x_{1})),(x_{2}, f(x_{2}))$ 这三个点，求满足经过三个点的 $f_{2}(x)$ 函数。
  
   - 假设$f_{2}(x)=f_{1}(x)+b_{2}(x-x_{0})(x-x_{1})$，$(x-x_{0})(x-x_{1})$ 可以保证  $f_{2}(x_{0})=f(x_{0}), f_{2}(x_{1})=f(x_{1})$
   
   - $b_{2}= \frac{f(x_2) - f_1(x_2)}{(x_2-x_0)(x_2-x_1)}= \frac{[\frac{f(x_{2})-f(x_{1})}{x_{2}-x_{1}}]-[\frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}]}{x_{2}-x_{0}}$
   
     $f_{2}(x)= f(x_{0})+\frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}(x-x_{0}) + \frac{[\frac{f(x_{2})-f(x_{1})}{x_{2}-x_{1}}]-[\frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}]}{x_{2}-x_{0}}(x-x_{0})(x-x_{1})$

观察$b_0,b_1,b_2,...$，可以发现规律。

先定义**均差**：

$k+1$级的均差的形式为：$f[x_{0}, \ldots, x_{k+1}]=\frac{f[x_{0}, x_{1}, \ldots, x_{k}]-f[x_{1}, \ldots, x_{k}, x_{k+1}]}{x_{0}-x_{k+1}}$（会发现上面$b_i$均为$i$级均差），此时原式

$f_{k+1}(x) = f(x_0) + f[x_0,x_1](x-x_0) + f[x_0,x_1,x_2](x-x_0)(x-x_1) + ... + f[x_0,x_1,...,x_{k+1}](x-x_0)(x-x_1)...(x-x_{k})  $

观察均差的参数是连续的，对于$k$级方差，末尾为$x_i$，往前直到$x_{i-k}$。对于新加入一个点$x_{k+1}$来说，不过多了一项$f[x_0,x_1,...,x_{k+1}]f(x_{k+1})$而已。令$table(i,j)$表示以$x_i$为末尾，长度为$j+1$的均差值。易得$table(i,j) = \frac{table(i,j-1) - table(i-1,j-1)}{x_i - x_{i-j}}$。

故$f_{k+1}(x) = f(x_0) + table(1,1)(x-x_0) + table(2,2)(x-x_0)(x-x_1)+ ... $

$+ table(k+1,k+1)(x-x_0)(x-x_1)...(x-x_{k})$

### 新加入一个点

对于$(x_{k+1},f(x_{k+1}))$，只需计算$table(k+1,0),table(k+1,1),...,table(k+1,k+1)$即可，复杂度为$O(n)$。

![](C:\Users\Administrator\Desktop\markdown图片\牛顿插值1.png)

### 计算某个点的值

可发现多项式中，每一项的多项式都是一个累乘形式，预处理前缀和，然后带入$b_i$，复杂度为$O(n)$。

## 泰勒展开

泰勒展开公式正是基于牛顿插值法得来。

对于插值的$n$个点来说，使横坐标等距，则每个点可记成$x_0,x_0 + \Delta x,x_0 + 2\Delta x,...$。会发现当$\Delta x$趋近$0$时所有的点都趋近于$x_0$，即$(x-x_0)(x-x_0-\Delta x)...(x-x_0-k\Delta x)\rightarrow (x-x_0)^{k+1}$；同时对于分母的**定值系数**$x_0 + k\Delta x - x_0 = k\Delta x$构成了阶乘，分子的$f$在$x_0$点。故$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$。通俗一点来说，即是泰勒展开的拟合函数$f_{n},n\rightarrow \infty$，点挨得无穷近，使得**k级均差中除去阶乘系数的部分**等同于**函数f在$x_0$点的k阶导**，项数趋近**无穷**则是由于拟合的点无穷多，根据牛顿插值的定义，越多点，项数越多。

麦克劳林级数就是泰勒展开式从点$x_0 = 0$处展开的、、

 

