# 计算机网络和因特网

## 协议

- 语法：制定传输文件（数据包）的格式，确定文件的语法结构。
- 语义：当某项行为发生后，机器要做何种响应（如何交互）
- 同步（时序）：事件实现的顺序

## 数据传输模式

主要有两种模式，分别为电路交换和分组交换。

### 电路交换（circuit switch）

特点：独占，点对点传输。

有两种数据切块的形式：

FDM（Frequency Division Multiplexing）：将数据传输按频率分成段传输。

TDM（Time Division Multiplexing）：将数据按时段分成段传输。

优点：无延迟，无拥塞。

缺点：需要建立连接，静态分配数据传输量，支持传输数据的链路少，容易产生由于闲置导致的资源的浪费。

### 分组交换（packet switch）

特点：按需分配（动态分配），储存后转发。

优点：支持传输数据的链路多（由于实际数据传输量的期望低，按需分配可以承载更多的链路），符合实际网络的突发性特点。

缺点：会发生堵塞，延迟，丢包等现象。

## 性能指标

在链路传输过程中，一个节点需要消耗的延迟可分为四个部分：

![image-20210307203658586](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210307203658586.png)

- 处理时延：给数据包查错；判断输出端口。微秒级别。
- 排队时延：数据包在队列中的时间。可长可短，跟堵塞强度有关
- 传输时延：跟两个值有关，一个是带宽R，一个是数据包大小L。该时延即为L / R。很小，跟包大小有关系。
- 传播时延：在两个节点间的物理传输时延，取决于物理距离d，传播速度s ~ 2e8 m / s，时延为 d / s 。很小，由于传播速度快。

公式即为 $d_{nodal} = d_{proc} + d_{queue} + d_{trans} + d_{prop}$ 。

> traceroute：一类命令。在 windows 下可以通过命令行 `tracert 域名` 来实现调用。会返回到该域名中，一系列经过的节点 ip 。带 * 号的可能是路由器问题，也有可能是过滤限制。如果过多带星号，说明 ip 和 路由 可能都有问题。

### 丢包

当数据包队列过长，以至于超过缓存队列的大小后，一些数据包就会被丢掉。

一般有两种衡量数据包的实际传输质量：丢包率：丢包数量 / 总数据包量；到达率：到达目的的数据包量 / 总数据包量。

### 吞吐量与宽带

吞吐量是速度，不是标量。

吞吐量仅对于接收端来说。一般输出端的吞吐量极大，瓶颈大部分在于接收的一端。

宽带是快读，串行，即数据包的间隔小。

## Internet协议栈

把网络实现独立分成了若干层，每层之间通过接口实现服务支持，对于平行的一层用协议进行交互，就构成了internet协议栈。

### 结构

工业上分为五层：应用层（应用调用各类进程）、传输层（进程与进程的交互）、网络层（端与端传输）、数据电路层（点与点传输）、物理层（比特流）

严格来说， TCP / IP 协议是四层结构，但目前一般提起 TCP / IP 协议，指的就是上面五层。ISO/OSI参考模型是7层。

### 数据传输形式

应用层将数据加个首部形成报文，传输层加个首部形成报文段，网络层加个首部形成数据报，数据电路层加头加尾形成帧，最后在物理层以比特流传输。

### 协议结构特点

对于五层结构来说，协议的数量多少成 “漏斗形” 分布，第一、第五层多，第二第三层少。