# 多项式基本公式

### 牛顿迭代$G(F(x)) \equiv 0(\bmod x^n)$

假设已求得$f_0(x)$，即$f(x)$在模$x^\frac{n}{2}$意义下的函数。

对$G(f(x))$进行关于$f(x)$在$f_0(x)$处的泰勒展开，有$\sum\limits_{i=0}^\infty \frac{G^{(i)}(f_0(x))}{i!}(f(x)-f_0(x))^i = 0$。

对于$(f(x)-f_0(x))^i = 0,i\geq 2$，得$G(f(x)) = G(f_0(x)) + \frac{G'(f_0(x))}{1}(f(x) - f_0(x)) \equiv 0 (\bmod x^n)$

得$f(x) \equiv f_0(x) - \frac{G(f_0(x))}{G'(f_0(x))}(\bmod x^n)$

通过构造$G(x)$，来递归求$f(x)$。

> 多项式取逆：
>
> $g(f(x))=\frac{1}{f(x)}-h(x) \equiv 0 \quad\left(\bmod x^{n}\right)$
>
> $\Rightarrow f(x) \equiv f_{0}(x)-\frac{\frac{1}{f_{0}(x)}-h(x)}{-\frac{1}{f_{0}^{2}(x)}}\quad\left(\bmod x^{n}\right)$
>
> $f(x) \equiv 2 f_{0}(x)-f_{0}^{2}(x) h(x)\quad\left(\bmod x^{n}\right)$

> 多项式开方：
>
> $g(f(x))=f^{2}(x)-h(x) \equiv 0 \quad\left(\bmod x^{n}\right)$
>
> $\Rightarrow f(x) \equiv f_{0}(x)-\frac{f_{0}^{2}(x)-h(x)}{2 f_{0}(x)}\quad\left(\bmod x^{n}\right)$
>
> $\equiv \frac{f_{0}^{2}(x)+h(x)}{2 f_{0}(x)} \quad\left(\bmod x^{n}\right)$

> 多项式Exp：
>
> $g(f(x))=\ln f(x)-h(x) \quad\left(\bmod x^{n}\right)$
>
> $f(x) \equiv f_{0}(x)-\frac{\ln f_{0}(x)-h(x)}{\frac{1}{f_{0}(x)}}\quad\left(\bmod x^{n}\right)$
> $\equiv f_{0}(x)\left(1-\ln f_{0}(x)+h(x)\right) \quad\left(\bmod x^{n}\right)$

> 另附多项式ln（虽然不用牛顿迭代求）：
>
> 求导再积分。
>
> $\begin{aligned}
>     \frac{\mathrm{d} \ln{f(x)}}{\mathrm{d} x} & \equiv \frac{f'(x)}{f(x)} & \pmod{x^{n}} \\
>     \ln{f(x)} & \equiv \int \mathrm{d} \ln{x} \equiv \int\frac{f'(x)}{f(x)} \mathrm{d} x & \pmod{x^{n}}
> \end{aligned}$

### 多项式k次方

一是用快速幂方法，复杂度为$O(n\log^2 n)$。不能接受。

二是利用$f^k(x) = \exp(k\ln f(x))$求解。复杂度$O(n\log n)$。

常数项不为1时：左移多项式至常数项非0。多项式每项同除常数项，以保证做运算的多项式常数项为1。记从左到右第$j$项第一个非零。

$f^k(x) = (x^jf_j\frac{f(x)}{f_jx^j})^k = f_j^k * x^{k*j}*(\frac{f(x)}{f_jx^j})^k = f_j^k * x^{kj}*\exp(k\ln(\frac{f(x)}{f_jx^j}))$

### $\sum\limits_{i=0}^n g_i$

有时候需要反复求某函数的前缀和。到时候拿月赛题目举例。

令$G(x) = \sum g_ix^i$，则直接$F(x) = G(x) * \frac{1}{1-x}$，那么$\sum\limits_{i=0}^n g_i = [x^n]F(x)$。

### $\sum\limits_{i=1}^n \frac{1}{1-a_ix}$

令$H(x) = \sum\limits_{i=1}^n\frac{1}{1-a_ix} = \sum\limits_{k=0}\sum\limits_{i=1}^na_i^kx^k$。

发现$\ln'(\frac{1}{1-ax}) = \frac{-a}{1-ax} = -a\sum (ax)^i$

则构造函数$G(x) = \sum\limits_{i=1}^n -a_i\sum\limits_{j=0}(a_ix)^j$，则可以通过$H(x) = -xG(x)+n$求得$H$。

$G(x) = \sum\limits_{i=1}^n \ln'(\frac{1}{1-a_ix}) = (\sum\limits_{i=1}^n \ln(\frac{1}{1-a_ix}))' = ( \ln(\prod\limits_{i=1}^n\frac{1}{1-a_ix}))'$。

令$T(x) = \prod\limits_{i=1}^n\frac{1}{1-a_ix} = \frac{1}{\prod\limits_{i=1}^n1-a_ix}$，其分母可以分治NTT求。

结果为$H(x) = -x\ln(T(x))' + n$。

### 累乘形式与累加形式转换

$\prod f_i(x) = \exp(\sum \ln(f_i(x)))$。这个是很基本的变换操作了。常见推理方式。

