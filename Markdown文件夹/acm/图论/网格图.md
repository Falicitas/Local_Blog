# 网格图

网格图有不少的特殊性质。

## 一些习题

## 扫雷

对于一个网格图，有一些雷。数字则统计周围的8格的雷的个数。

问是否存在另一张图，使另一张图的数字总和等于原图数字总和。

解：直接把图给反过来，即数字换雷，雷换数字，发现是相等的。

这就很神奇了。可以从雷->数字建边算贡献来理解。图反过来了，相当于原来的边反过来了，但是不会有新增的边，所以边的总贡献一样。

### P3350 [ZJOI2016]旅行者

这个题利用网格图的最短路特性，由于每个点对的查询是随机在网格的位置，那么将网格图对半分，对于处在网格图左右部分的查询点必然要经过中间的轴线上的点。

于是考虑每次只求轴线上的点到整个网格图的最短路，那么对于任意被轴线隔开的查询点，答案即为$d((x_1,y_1),中轴线某一点)+d(中轴线某一点,(x_2,y_2))$。对于其他仍处在当前网格图的查询点也需要更新一下（由于一个点对的最短路需要经过中轴线再绕回所处的网格范围）

比起复杂度$O(qnm)$，明显$O(nm\log nm)$级别更优秀。故采用这种分治的办法来求解。本质是利用的网格图两点路径必然要经过某条 **人为规划** 的界线，以此来在界线上求最短路来更新查询点对。